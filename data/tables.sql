CREATE TABLE `PLAYER_STATS_TOTAL`(
    `game_id` TEXT NOT NULL,
    `steam_id` TEXT NOT NULL,
    `name` TEXT NOT NULL,
    `team_name` TEXT NOT NULL,
    `side` INTEGER NOT NULL,
    `rounds` INTEGER NOT NULL,
    `damage` INTEGER NOT NULL,
    `kills` INTEGER NOT NULL,
    `assists` INTEGER NOT NULL,
    `deaths` INTEGER NOT NULL,
    `death_placement` REAL NOT NULL,
    `ticks_alive` INTEGER NOT NULL,
    `trades` INTEGER NOT NULL,
    `traded` INTEGER NOT NULL,
    `opening_kills` INTEGER NOT NULL,
    `opening_deaths` INTEGER NOT NULL,
    `cl_1` INTEGER NOT NULL,
    `cl_2` INTEGER NOT NULL,
    `cl_3` INTEGER NOT NULL,
    `cl_4` INTEGER NOT NULL,
    `cl_5` INTEGER NOT NULL,
    `twoK` INTEGER NOT NULL,
    `threeK` INTEGER NOT NULL,
    `fourK` INTEGER NOT NULL,
    `fiveK` INTEGER NOT NULL,
    `nade_dmg` INTEGER NOT NULL,
    `fire_dmg` INTEGER NOT NULL,
    `util_dmg` INTEGER NOT NULL,
    `ef` INTEGER NOT NULL,
    `f_ass` INTEGER NOT NULL,
    `enemy_flash_time` REAL NOT NULL,
    `hs` INTEGER NOT NULL,
    `kast_rounds` INTEGER NOT NULL,
    `saves` INTEGER NOT NULL,
    `entries` INTEGER NOT NULL,
    `awp_kills` INTEGER NOT NULL,
    `rounds_for` INTEGER NOT NULL,
    `rounds_against` INTEGER NOT NULL,
    `nades_thrown` INTEGER NOT NULL,
    `fires_thrown` INTEGER NOT NULL,
    `flash_thrown` INTEGER NOT NULL,
    `smoke_thrown` INTEGER NOT NULL,
    `damage_taken` INTEGER NOT NULL,
    `supp_rounds` INTEGER NOT NULL,
    `supp_dmg` INTEGER NOT NULL,
    `lurk_rounds` INTEGER NOT NULL,
    `wlp` REAL NOT NULL,
    `mip` REAL NOT NULL,
    `round_win_shares` REAL NOT NULL,
    `eac` INTEGER NOT NULL,
    `rounds_with_kills` INTEGER NOT NULL,
    `util_thrown` INTEGER NOT NULL,
    `atd` INTEGER NOT NULL,
    `kast` REAL NOT NULL,
    `kpa` REAL NOT NULL,
    `iiwr` REAL NOT NULL,
    `adr` REAL NOT NULL,
    `dr_diff` REAL NOT NULL,
    `kr` REAL NOT NULL,
    `trade_ratio` REAL NOT NULL,
    `impact` REAL NOT NULL,
    `rating` REAL NOT NULL,
    FOREIGN KEY(`game_id`) REFERENCES GAMES(`game_id`),
    FOREIGN KEY(`steam_id`) REFERENCES PLAYER_IDS(`steam_id`),
    PRIMARY KEY(`game_id`,`steam_id`)
);
CREATE TABLE `PLAYER_STATS_CT`(
    `game_id` TEXT NOT NULL,
    `steam_id` TEXT NOT NULL,
    `name` TEXT NOT NULL,
    `team_name` TEXT NOT NULL,
    `side` INTEGER NOT NULL,
    `rounds` INTEGER NOT NULL,
    `damage` INTEGER NOT NULL,
    `kills` INTEGER NOT NULL,
    `assists` INTEGER NOT NULL,
    `deaths` INTEGER NOT NULL,
    `death_placement` REAL NOT NULL,
    `ticks_alive` INTEGER NOT NULL,
    `trades` INTEGER NOT NULL,
    `traded` INTEGER NOT NULL,
    `opening_kills` INTEGER NOT NULL,
    `opening_deaths` INTEGER NOT NULL,
    `cl_1` INTEGER NOT NULL,
    `cl_2` INTEGER NOT NULL,
    `cl_3` INTEGER NOT NULL,
    `cl_4` INTEGER NOT NULL,
    `cl_5` INTEGER NOT NULL,
    `twoK` INTEGER NOT NULL,
    `threeK` INTEGER NOT NULL,
    `fourK` INTEGER NOT NULL,
    `fiveK` INTEGER NOT NULL,
    `nade_dmg` INTEGER NOT NULL,
    `fire_dmg` INTEGER NOT NULL,
    `util_dmg` INTEGER NOT NULL,
    `ef` INTEGER NOT NULL,
    `f_ass` INTEGER NOT NULL,
    `enemy_flash_time` REAL NOT NULL,
    `hs` INTEGER NOT NULL,
    `kast_rounds` INTEGER NOT NULL,
    `saves` INTEGER NOT NULL,
    `entries` INTEGER NOT NULL,
    `awp_kills` INTEGER NOT NULL,
    `rounds_for` INTEGER NOT NULL,
    `rounds_against` INTEGER NOT NULL,
    `nades_thrown` INTEGER NOT NULL,
    `fires_thrown` INTEGER NOT NULL,
    `flash_thrown` INTEGER NOT NULL,
    `smoke_thrown` INTEGER NOT NULL,
    `damage_taken` INTEGER NOT NULL,
    `supp_rounds` INTEGER NOT NULL,
    `supp_dmg` INTEGER NOT NULL,
    `lurk_rounds` INTEGER NOT NULL,
    `wlp` REAL NOT NULL,
    `mip` REAL NOT NULL,
    `round_win_shares` REAL NOT NULL,
    `eac` INTEGER NOT NULL,
    `rounds_with_kills` INTEGER NOT NULL,
    `util_thrown` INTEGER NOT NULL,
    `atd` INTEGER NOT NULL,
    `kast` REAL NOT NULL,
    `kpa` REAL NOT NULL,
    `iiwr` REAL NOT NULL,
    `adr` REAL NOT NULL,
    `dr_diff` REAL NOT NULL,
    `kr` REAL NOT NULL,
    `trade_ratio` REAL NOT NULL,
    `impact` REAL NOT NULL,
    `rating` REAL NOT NULL,
    FOREIGN KEY(`game_id`) REFERENCES GAMES(`game_id`),
    FOREIGN KEY(`steam_id`) REFERENCES PLAYER_IDS(`steam_id`),
    PRIMARY KEY(`game_id`,`steam_id`)
);
CREATE TABLE `PLAYER_STATS_T`(
    `game_id` TEXT NOT NULL,
    `steam_id` TEXT NOT NULL,
    `name` TEXT NOT NULL,
    `team_name` TEXT NOT NULL,
    `side` INTEGER NOT NULL,
    `rounds` INTEGER NOT NULL,
    `damage` INTEGER NOT NULL,
    `kills` INTEGER NOT NULL,
    `assists` INTEGER NOT NULL,
    `deaths` INTEGER NOT NULL,
    `death_placement` REAL NOT NULL,
    `ticks_alive` INTEGER NOT NULL,
    `trades` INTEGER NOT NULL,
    `traded` INTEGER NOT NULL,
    `opening_kills` INTEGER NOT NULL,
    `opening_deaths` INTEGER NOT NULL,
    `cl_1` INTEGER NOT NULL,
    `cl_2` INTEGER NOT NULL,
    `cl_3` INTEGER NOT NULL,
    `cl_4` INTEGER NOT NULL,
    `cl_5` INTEGER NOT NULL,
    `twoK` INTEGER NOT NULL,
    `threeK` INTEGER NOT NULL,
    `fourK` INTEGER NOT NULL,
    `fiveK` INTEGER NOT NULL,
    `nade_dmg` INTEGER NOT NULL,
    `fire_dmg` INTEGER NOT NULL,
    `util_dmg` INTEGER NOT NULL,
    `ef` INTEGER NOT NULL,
    `f_ass` INTEGER NOT NULL,
    `enemy_flash_time` REAL NOT NULL,
    `hs` INTEGER NOT NULL,
    `kast_rounds` INTEGER NOT NULL,
    `saves` INTEGER NOT NULL,
    `entries` INTEGER NOT NULL,
    `awp_kills` INTEGER NOT NULL,
    `rounds_for` INTEGER NOT NULL,
    `rounds_against` INTEGER NOT NULL,
    `nades_thrown` INTEGER NOT NULL,
    `fires_thrown` INTEGER NOT NULL,
    `flash_thrown` INTEGER NOT NULL,
    `smoke_thrown` INTEGER NOT NULL,
    `damage_taken` INTEGER NOT NULL,
    `supp_rounds` INTEGER NOT NULL,
    `supp_dmg` INTEGER NOT NULL,
    `lurk_rounds` INTEGER NOT NULL,
    `wlp` REAL NOT NULL,
    `mip` REAL NOT NULL,
    `round_win_shares` REAL NOT NULL,
    `eac` INTEGER NOT NULL,
    `rounds_with_kills` INTEGER NOT NULL,
    `util_thrown` INTEGER NOT NULL,
    `atd` INTEGER NOT NULL,
    `kast` REAL NOT NULL,
    `kpa` REAL NOT NULL,
    `iiwr` REAL NOT NULL,
    `adr` REAL NOT NULL,
    `dr_diff` REAL NOT NULL,
    `kr` REAL NOT NULL,
    `trade_ratio` REAL NOT NULL,
    `impact` REAL NOT NULL,
    `rating` REAL NOT NULL,
    FOREIGN KEY(`game_id`) REFERENCES GAMES(`game_id`),
    FOREIGN KEY(`steam_id`) REFERENCES PLAYER_IDS(`steam_id`),
    PRIMARY KEY(`game_id`,`steam_id`)
);
CREATE TABLE `PLAYERS`(
    `steam_id` TEXT NOT NULL,
    `name` TEXT NOT NULL,
    `team` TEXT NULL,
    `mmr` INTEGER NULL,
    PRIMARY KEY(`steam_id`)
);
CREATE TABLE `FRANCHISES`(
    `franchise_name` TEXT NOT NULL,
    `abbreviation` TEXT NOT NULL,
    `gm` TEXT NULL,
    `agm_1` TEXT NULL,
    `agm_2` TEXT NULL,
    PRIMARY KEY(`franchise_name`)
);
CREATE TABLE `TEAMS`(
    `team_name` TEXT NOT NULL,
    `franchise_name` TEXT NOT NULL,
    `tier` TEXT NOT NULL,
    FOREIGN KEY(`franchise_name`) REFERENCES FRANCHISES(`franchise_name`),
    FOREIGN KEY(`tier`) REFERENCES TIERS(`tier_name`),
    PRIMARY KEY(`team_name`)
);
CREATE TABLE `GAMES`(
    `game_id` TEXT NOT NULL,
    `team_a` TEXT NOT NULL,
    `team_b` TEXT NOT NULL,
    `map` TEXT NOT NULL,
    `winner` TEXT NOT NULL,
    `match_type` TEXT NULL,
    `date` TEXT NULL,
    `csc_id` TEXT NULL,
    FOREIGN KEY(`team_a`) REFERENCES TEAMS(`team_name`),
    FOREIGN KEY(`team_b`) REFERENCES TEAMS(`team_name`),
    FOREIGN KEY(`map`) REFERENCES MAPS(`map`),
    FOREIGN KEY(`winner`) REFERENCES TEAMS(`team_name`),
    PRIMARY KEY(`game_id`)
);
CREATE TABLE `TIERS`(
    `tier_name` TEXT NOT NULL,
    PRIMARY KEY(`tier_name`)
);
CREATE TABLE `MAPS`(
    `map` TEXT NOT NULL,
    PRIMARY KEY(`map`)
);
CREATE TABLE `TEAM_STATS`(
    `game_id` TEXT NOT NULL,
    `team_name` TEXT NOT NULL,
    `rounds` INTEGER NOT NULL,
    `rounds_won` INTEGER NOT NULL,
    `ct_rounds` INTEGER NOT NULL,
    `ct_rounds_won` INTEGER NOT NULL,
    `t_rounds` INTEGER NOT NULL,
    `t_rounds_won` INTEGER NOT NULL,
    `fiveVFour_count` INTEGER NOT NULL,
    `fiveVFour_wins` INTEGER NOT NULL,
    `fourVFive_count` INTEGER NOT NULL,
    `fourVFive_wins` INTEGER NOT NULL,
    `pistol_rounds` INTEGER NOT NULL,
    `pistol_wins` INTEGER NOT NULL,
    `saves` INTEGER NOT NULL,
    `clutches` INTEGER NOT NULL,
    `traded` INTEGER NOT NULL,
    `f_ass` INTEGER NOT NULL,
    `ef` INTEGER NOT NULL,
    `util_dmg` INTEGER NOT NULL,
    `util_thrown` INTEGER NOT NULL,
    `deaths` INTEGER NOT NULL,
    FOREIGN KEY(`game_id`) REFERENCES GAMES(`game_id`),
    FOREIGN KEY(`team_name`) REFERENCES TEAMS(`team_name`),
    PRIMARY KEY(`game_id`,`team_name`)
);
CREATE TABLE `GAME_ROUNDS`(
    `game_id` TEXT NOT NULL,
    `round_num` INTEGER NOT NULL,
    `winner_team` TEXT NOT NULL,
    `winner_side` TEXT NOT NULL,
    `round_end_reason` TEXT NOT NULL,
    `planter` TEXT NULL,
    `defuser` TEXT NULL,
    FOREIGN KEY(`game_id`) REFERENCES GAMES(`game_id`),
    FOREIGN KEY(`winner_team`) REFERENCES TEAMS(`team_name`),
    FOREIGN KEY(`planter`) REFERENCES PLAYER_IDS(`steam_id`),
    FOREIGN KEY(`defuser`) REFERENCES TEAMS(`steam_id`),
    PRIMARY KEY(`game_id`,round_num)
);